AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
AADC Trial license days remaining: 608
================================================================================
           SIMM Portfolio AADC
================================================================================
Configuration:
  Model:           simm_portfolio_aadc_py v3.3.0
  Trade Types:     ir_swap
  Trades:          100
  SIMM Buckets:    2
  Portfolios:      3
  Threads:         8 (AADC workers)

Generating market data...
Generating 100 ir_swap trades...
  Total trades: 100
Portfolio allocation:
  Group 0: 33 trades
  Group 1: 36 trades
  Group 2: 31 trades

Processing groups (AADC CRIF -> SIMM -> AADC dIM/ds -> trade contributions)...

  Group 0 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000005       120,478,109,216,641.78 150235.19%
    IR_SWAP_000057       107,425,373,589,175.66 133958.54%
    IR_SWAP_000091       -88,879,868,224,670.81 -110832.45%
    IR_SWAP_000081       -32,631,641,953,187.73 -40691.38%
    IR_SWAP_000098       16,743,307,205,032.68  20878.76%
    IR_SWAP_000089       -9,048,693,072,806.39 -11283.64%
    IR_SWAP_000087       6,661,119,061,680.71   8306.36%
    IR_SWAP_000025       -5,490,976,915,734.92  -6847.20%
    IR_SWAP_000026       -5,458,802,716,916.29  -6807.08%
    IR_SWAP_000061       -4,548,796,550,144.04  -5672.31%
    IR_SWAP_000012       -4,548,796,550,144.04  -5672.31%
    IR_SWAP_000015       4,493,388,084,342.86   5603.22%
    IR_SWAP_000096       4,493,388,084,342.86   5603.22%
    IR_SWAP_000084       -4,180,428,965,813.77  -5212.96%
    IR_SWAP_000021       -3,923,389,081,765.89  -4892.43%
    IR_SWAP_000040       -3,315,452,349,246.08  -4134.34%
    IR_SWAP_000095         965,290,691,310.07   1203.71%
    IR_SWAP_000038        -910,240,805,896.04  -1135.06%
    IR_SWAP_000024         859,436,978,743.20   1071.71%
    IR_SWAP_000092        -650,276,523,384.35   -810.89%
    IR_SWAP_000020        -650,276,523,384.35   -810.89%
    IR_SWAP_000047         584,825,100,138.17    729.27%
    IR_SWAP_000053         539,891,546,289.58    673.24%
    IR_SWAP_000069         408,025,818,156.73    508.80%
    IR_SWAP_000094         197,594,476,616.07    246.40%
    IR_SWAP_000004         145,925,788,742.84    181.97%
    IR_SWAP_000090        -141,474,451,300.91   -176.42%
    IR_SWAP_000044        -109,727,128,057.14   -136.83%
    IR_SWAP_000051         109,072,126,304.11    136.01%
    IR_SWAP_000043         104,824,109,243.81    130.71%
    IR_SWAP_000001          74,870,879,112.85     93.36%
    IR_SWAP_000099         -40,278,321,441.28    -50.23%
    IR_SWAP_000083         -14,955,020,249.75    -18.65%
    ----------------------------------------------------
    Sum                  99,740,367,601,730.22 (IM = 80,193,003,917.29)

  Group 1 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000073       46,603,452,217,105.52  59199.70%
    IR_SWAP_000067       -27,335,527,756,552.39 -34723.93%
    IR_SWAP_000085       -27,335,527,756,552.39 -34723.93%
    IR_SWAP_000030       21,653,915,922,960.01  27506.66%
    IR_SWAP_000046       17,870,801,618,198.57  22701.02%
    IR_SWAP_000049       17,870,801,618,198.57  22701.02%
    IR_SWAP_000018       16,374,090,887,784.75  20799.77%
    IR_SWAP_000071       -16,285,710,576,464.56 -20687.51%
    IR_SWAP_000060       -12,882,559,446,103.58 -16364.53%
    IR_SWAP_000019       8,936,474,848,487.85  11351.88%
    IR_SWAP_000022       -8,129,578,958,043.80 -10326.89%
    IR_SWAP_000079       -8,129,578,958,043.80 -10326.89%
    IR_SWAP_000035       7,498,270,457,554.50   9524.95%
    IR_SWAP_000007       6,568,462,488,521.50   8343.82%
    IR_SWAP_000066       6,568,462,488,521.50   8343.82%
    IR_SWAP_000075       6,353,033,474,626.28   8070.17%
    IR_SWAP_000017       -4,439,800,796,305.41  -5639.82%
    IR_SWAP_000054       4,210,722,535,139.69   5348.82%
    IR_SWAP_000082       4,210,722,535,139.69   5348.82%
    IR_SWAP_000023       2,653,465,368,612.38   3370.66%
    IR_SWAP_000048       -2,162,275,121,755.85  -2746.71%
    IR_SWAP_000064       -1,637,383,615,533.14  -2079.95%
    IR_SWAP_000032       1,543,205,512,601.73   1960.31%
    IR_SWAP_000072        -909,136,722,547.85  -1154.86%
    IR_SWAP_000088         768,927,282,714.13    976.76%
    IR_SWAP_000050         640,416,580,155.02    813.51%
    IR_SWAP_000016         636,324,535,866.51    808.31%
    IR_SWAP_000074         616,553,347,589.80    783.20%
    IR_SWAP_000033         506,818,060,630.10    643.80%
    IR_SWAP_000014        -474,352,303,901.32   -602.56%
    IR_SWAP_000065         363,666,662,777.61    461.96%
    IR_SWAP_000052         273,494,844,779.79    347.42%
    IR_SWAP_000068         181,200,133,685.65    230.18%
    IR_SWAP_000076        -163,521,152,525.12   -207.72%
    IR_SWAP_000063        -163,521,152,525.12   -207.72%
    IR_SWAP_000062         -27,711,928,008.74    -35.20%
    ----------------------------------------------------
    Sum                  62,827,097,176,788.05 (IM = 78,722,444,864.84)

  Group 2 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000027       32,703,334,541,804.89  54527.95%
    IR_SWAP_000000       19,263,550,470,530.09  32119.11%
    IR_SWAP_000028       19,263,550,470,530.09  32119.11%
    IR_SWAP_000031       12,233,890,288,613.62  20398.20%
    IR_SWAP_000078       -10,869,092,279,898.79 -18122.60%
    IR_SWAP_000011       -8,164,336,527,447.08 -13612.82%
    IR_SWAP_000059       -8,164,336,527,447.07 -13612.82%
    IR_SWAP_000036       3,694,729,817,363.52   6160.41%
    IR_SWAP_000034       -3,601,868,424,911.74  -6005.58%
    IR_SWAP_000077       3,577,929,305,616.05   5965.67%
    IR_SWAP_000003       -1,346,891,818,837.09  -2245.74%
    IR_SWAP_000055         883,624,765,527.44   1473.31%
    IR_SWAP_000056         725,620,835,397.63   1209.86%
    IR_SWAP_000070         232,165,345,727.21    387.10%
    IR_SWAP_000058         156,564,814,992.38    261.05%
    IR_SWAP_000002        -132,223,601,718.04   -220.46%
    IR_SWAP_000045         131,862,158,912.19    219.86%
    IR_SWAP_000037         -94,420,143,955.68   -157.43%
    IR_SWAP_000097         -91,263,288,610.84   -152.17%
    IR_SWAP_000013         -55,718,920,799.67    -92.90%
    IR_SWAP_000039          37,014,483,168.41     61.72%
    IR_SWAP_000041          35,432,858,316.27     59.08%
    IR_SWAP_000029         -23,564,995,690.76    -39.29%
    IR_SWAP_000009          22,136,150,468.48     36.91%
    IR_SWAP_000042          22,136,150,468.48     36.91%
    IR_SWAP_000006         -19,521,955,705.95    -32.55%
    IR_SWAP_000093         -16,279,852,484.68    -27.14%
    IR_SWAP_000008           4,994,983,637.25      8.33%
    IR_SWAP_000080           3,634,887,640.02      6.06%
    IR_SWAP_000086          -2,305,050,446.75     -3.84%
    IR_SWAP_000010           2,042,101,892.22      3.40%
    ----------------------------------------------------
    Sum                  60,412,391,042,652.08 (IM = 59,975,356,959.05)

CRIF logged: 581 rows -> /home/natashamanito/ISDA-SIMM/data/crif_output.csv
Trade contributions logged: 100 rows -> /home/natashamanito/ISDA-SIMM/data/trade_contributions.csv


Full Optimization (method=gradient_descent)...
  Precomputing trade CRIFs...
  Sensitivity matrix: 100 trades x 20 risk factors x 3 portfolios
  Recording efficient kernel (K=20 inputs, NOT TÃ—P=300)...
  Using ISDA v2.6 correlations: True
  Kernel recorded: 20 inputs (100-1000x smaller than old approach)
  Initial total IM: $164,934,753,240.68
  Running gradient_descent optimization with chain rule gradients...
    Initial IM: $164,934,753,240.68
    Gradient: max=7.83e+10, mean=7.56e+09
    Learning rate: 3.83e-12
    Iter 0: IM = $164,934,753,240.68, moves = 0
    Iter 10: IM = $146,342,484,543.06, moves = 2
    Iter 20: IM = $160,727,615,908.19, moves = 2
    Iter 30: IM = $165,941,901,486.27, moves = 2
    Iter 40: IM = $168,268,861,692.61, moves = 2
    Iter 50: IM = $169,310,498,189.71, moves = 2
    Iter 60: IM = $169,421,082,814.46, moves = 2
    Iter 70: IM = $169,170,768,341.08, moves = 2
    Iter 80: IM = $168,831,506,510.95, moves = 2
    Iter 90: IM = $168,469,475,951.63, moves = 2
    Reached max iterations (100)
    Allocation distribution: 26 trades with max_alloc < 0.9, 1 near 50/50
    Most mixed allocations (top 5):
      Trade 57: [0.43319735 0.         0.56680265] (max=0.567)
      Trade 71: [0.17116763 0.61032904 0.21850333] (max=0.610)
      Trade 5: [0.28835616 0.09150149 0.62014235] (max=0.620)
      Trade 60: [0.15223489 0.64091881 0.2068463 ] (max=0.641)
      Trade 73: [0.33827697 0.64440291 0.01732011] (max=0.644)
  Continuous IM (before rounding): $168,170,660,690.25

Optimization Summary:
  Method:              gradient_descent
  Iterations:          100 (max iters)
  Initial IM:          $164,934,753,240.68
  Optimized IM:        $172,399,042,819.57
  Reduction:           -4.5%
  Trades moved:        2 of 100
  Optimization time:   3.039 s

Group   Trades           IM (USD)   CRIF (s)   SIMM (s)  # Sens dIM/ds (s)
--------------------------------------------------------------------------
  0         33  80,193,003,917.29      1.219   0.131950     195      0.642
  1         36  78,722,444,864.84      1.135   0.133576     201      0.669
  2         31  59,975,356,959.05      1.171   0.133527     185      0.563
--------------------------------------------------------------------------
  ALL      100 218,890,805,741.18      3.525   0.399053     581      1.874

Timing Summary (AADC):
  CRIF (AADC):       3.525 s (3 groups)
  SIMM aggregation:  0.399053 s (3 groups)
  IM gradient (AADC): 1.874 s (581 sensitivities, single adjoint)
  Optimization:      3.039 s (100 iterations, 2 trades moved)
  Total:             8.838 s

Execution logged to /home/natashamanito/ISDA-SIMM/data/execution_log_portfolio.csv
================================================================================
