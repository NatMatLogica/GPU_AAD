AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
AADC Trial license days remaining: 607
================================================================================
           SIMM Portfolio AADC
================================================================================
Configuration:
  Model:           simm_portfolio_aadc_py v3.3.0
  Trade Types:     ir_swap
  Trades:          100
  SIMM Buckets:    2
  Portfolios:      3
  Threads:         8 (AADC workers)

Generating market data...
Generating 100 ir_swap trades...
  Total trades: 100
Portfolio allocation:
  Group 0: 33 trades
  Group 1: 36 trades
  Group 2: 31 trades

Processing groups (AADC CRIF -> SIMM -> AADC dIM/ds -> trade contributions)...

  Group 0 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000005       124,852,585,327,793.97 131725.67%
    IR_SWAP_000057       116,354,294,635,692.75 122759.55%
    IR_SWAP_000091       -93,281,120,818,367.20 -98416.21%
    IR_SWAP_000081       -33,880,874,221,339.45 -35746.00%
    IR_SWAP_000098       17,565,332,266,132.16  18532.30%
    IR_SWAP_000089       -9,100,363,995,064.46  -9601.34%
    IR_SWAP_000087       6,905,153,002,860.88   7285.28%
    IR_SWAP_000025       -5,500,497,043,573.32  -5803.30%
    IR_SWAP_000026       -5,468,320,901,508.10  -5769.35%
    IR_SWAP_000012       -5,162,406,329,943.39  -5446.59%
    IR_SWAP_000061       -5,162,406,329,943.39  -5446.59%
    IR_SWAP_000015       4,659,172,440,629.58   4915.66%
    IR_SWAP_000096       4,659,172,440,629.58   4915.66%
    IR_SWAP_000021       -3,970,128,412,959.03  -4188.68%
    IR_SWAP_000084       -3,673,808,112,448.23  -3876.05%
    IR_SWAP_000040       -3,353,641,679,347.25  -3538.26%
    IR_SWAP_000095       1,010,838,391,558.43   1066.48%
    IR_SWAP_000024         926,557,640,703.31    977.56%
    IR_SWAP_000038        -915,425,449,970.99   -965.82%
    IR_SWAP_000020        -715,993,707,027.85   -755.41%
    IR_SWAP_000092        -715,993,707,027.85   -755.41%
    IR_SWAP_000047         552,375,854,042.94    582.78%
    IR_SWAP_000053         512,401,883,197.26    540.61%
    IR_SWAP_000069         358,834,023,873.14    378.59%
    IR_SWAP_000094         199,954,811,387.54    210.96%
    IR_SWAP_000051         122,025,275,810.11    128.74%
    IR_SWAP_000090        -120,605,900,151.59   -127.25%
    IR_SWAP_000004         119,658,927,119.91    126.25%
    IR_SWAP_000043         116,138,824,314.60    122.53%
    IR_SWAP_000044        -109,922,545,453.71   -115.97%
    IR_SWAP_000001          61,385,066,748.12     64.76%
    IR_SWAP_000099         -35,419,542,060.80    -37.37%
    IR_SWAP_000083         -12,261,416,931.64    -12.94%
    ----------------------------------------------------
    Sum                  107,796,690,699,375.98 (IM = 94,782,271,769.65)

  Group 1 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000073       45,865,997,060,782.20  79618.83%
    IR_SWAP_000067       -27,197,187,052,222.78 -47211.63%
    IR_SWAP_000085       -27,197,187,052,222.77 -47211.63%
    IR_SWAP_000030       21,528,029,258,922.81  37370.53%
    IR_SWAP_000046       18,740,843,837,134.86  32532.25%
    IR_SWAP_000049       18,740,843,837,134.86  32532.25%
    IR_SWAP_000071       -15,991,485,005,748.19 -27759.64%
    IR_SWAP_000018       15,868,284,497,040.37  27545.77%
    IR_SWAP_000060       -13,455,835,478,914.55 -23358.00%
    IR_SWAP_000079       -11,085,021,335,293.97 -19242.50%
    IR_SWAP_000022       -11,085,021,335,293.97 -19242.50%
    IR_SWAP_000019       9,371,352,458,982.96  16267.74%
    IR_SWAP_000035       7,343,107,706,431.10  12746.91%
    IR_SWAP_000007       6,897,902,799,593.08  11974.08%
    IR_SWAP_000066       6,897,902,799,593.07  11974.08%
    IR_SWAP_000075       6,805,015,005,698.48  11812.83%
    IR_SWAP_000017       -4,405,729,406,385.98  -7647.91%
    IR_SWAP_000054       4,015,701,890,807.51   6970.86%
    IR_SWAP_000082       4,015,701,890,807.51   6970.86%
    IR_SWAP_000023       2,771,753,247,658.60   4811.49%
    IR_SWAP_000048       -2,274,677,477,887.69  -3948.62%
    IR_SWAP_000064       -1,805,058,368,612.97  -3133.40%
    IR_SWAP_000032       1,704,719,126,678.50   2959.22%
    IR_SWAP_000072        -942,390,300,536.78  -1635.90%
    IR_SWAP_000088         753,323,481,823.19   1307.70%
    IR_SWAP_000016         668,658,327,984.59   1160.72%
    IR_SWAP_000074         659,940,597,008.49   1145.59%
    IR_SWAP_000050         659,867,625,637.71   1145.46%
    IR_SWAP_000033         547,350,295,448.83    950.15%
    IR_SWAP_000014        -468,587,979,191.88   -813.42%
    IR_SWAP_000065         381,214,740,510.21    661.75%
    IR_SWAP_000052         306,073,261,330.38    531.31%
    IR_SWAP_000063        -222,150,499,641.56   -385.63%
    IR_SWAP_000076        -222,150,499,641.56   -385.63%
    IR_SWAP_000068         190,018,282,607.64    329.85%
    IR_SWAP_000062         -31,015,627,787.51    -53.84%
    ----------------------------------------------------
    Sum                  58,350,104,610,234.77 (IM = 57,606,968,655.84)

  Group 2 Trade Contributions (Euler decomposition):
    TradeID                Contribution (USD)    % of IM
    ----------------------------------------------------
    IR_SWAP_000027       33,261,156,365,893.79  55263.01%
    IR_SWAP_000028       19,322,319,694,958.32  32103.80%
    IR_SWAP_000000       19,322,319,694,958.31  32103.80%
    IR_SWAP_000031       12,295,221,975,262.81  20428.36%
    IR_SWAP_000078       -10,659,510,599,764.32 -17710.65%
    IR_SWAP_000011       -8,600,420,827,433.56 -14289.50%
    IR_SWAP_000059       -8,600,420,827,433.56 -14289.50%
    IR_SWAP_000036       3,892,043,128,303.47   6466.58%
    IR_SWAP_000034       -3,616,661,125,829.18  -6009.04%
    IR_SWAP_000077       3,592,605,225,764.72   5969.07%
    IR_SWAP_000003       -1,354,484,241,161.84  -2250.46%
    IR_SWAP_000045       1,346,653,725,426.58   2237.45%
    IR_SWAP_000002       -1,063,125,007,866.90  -1766.37%
    IR_SWAP_000013        -914,243,941,638.49  -1519.01%
    IR_SWAP_000055         855,132,035,533.75   1420.79%
    IR_SWAP_000056         728,578,913,423.49   1210.53%
    IR_SWAP_000070         712,542,379,718.25   1183.88%
    IR_SWAP_000037        -244,482,716,787.22   -406.21%
    IR_SWAP_000097        -240,873,119,638.32   -400.21%
    IR_SWAP_000058         157,125,653,757.12    261.06%
    IR_SWAP_000039         137,450,938,935.09    228.37%
    IR_SWAP_000093        -130,080,150,121.56   -216.13%
    IR_SWAP_000041         129,453,890,333.80    215.09%
    IR_SWAP_000029         -72,387,113,815.05   -120.27%
    IR_SWAP_000006         -71,784,993,175.35   -119.27%
    IR_SWAP_000009          68,937,230,219.29    114.54%
    IR_SWAP_000042          68,937,230,219.29    114.54%
    IR_SWAP_000008          36,456,890,768.09     60.57%
    IR_SWAP_000080          26,259,010,214.01     43.63%
    IR_SWAP_000010          22,434,736,830.63     37.28%
    IR_SWAP_000086          -7,089,911,181.21    -11.78%
    ----------------------------------------------------
    Sum                  60,400,064,144,674.26 (IM = 60,187,011,276.55)

CRIF logged: 551 rows -> /home/natashamanito/ISDA-SIMM/data/crif_output.csv
Trade contributions logged: 100 rows -> /home/natashamanito/ISDA-SIMM/data/trade_contributions.csv


Full Optimization (method=gradient_descent)...
  Precomputing trade CRIFs...
  Sensitivity matrix: 100 trades x 20 risk factors x 3 portfolios
  Recording efficient kernel (K=20 inputs, NOT TÃ—P=300)...
  Using ISDA v2.6 correlations: True
  Kernel recorded: 20 inputs (100-1000x smaller than old approach)
  Initial total IM: $170,434,246,031.14
  Running gradient_descent optimization with chain rule gradients...
    Initial IM: $170,434,246,031.14
    Gradient: max=7.81e+10, mean=6.55e+09
    Learning rate: 1.00e-03
    Iter 0: IM = $170,434,246,031.14, best = $170,434,246,031.14, moves = 0
    Iter 10: IM = $170,434,246,031.14, best = $170,434,246,031.14, moves = 0
    Stalled for 20 iterations, reverting to best
    Allocation distribution: 0 trades with max_alloc < 0.9, 0 near 50/50
    Most mixed allocations (top 5):
      Trade 0: [0. 0. 1.] (max=1.000)
      Trade 1: [1. 0. 0.] (max=1.000)
      Trade 2: [0. 0. 1.] (max=1.000)
      Trade 3: [0. 0. 1.] (max=1.000)
      Trade 4: [1. 0. 0.] (max=1.000)
  Continuous IM (before rounding): $170,434,246,031.14
  Greedy rounding: 100 decided (>=80%), 0 searched (0 IM evaluations)
  IM after greedy rounding: $170,434,246,031.14
  Running post-rounding local search...
  Local search round 1: move trade 57 (0->2), IM -$96,775,749,381 -> $73,658,496,650.44
  Local search round 2: move trade 78 (2->1), IM -$6,446,472,470 -> $67,212,024,179.96
  Local search round 3: move trade 82 (1->2), IM -$1,811,705,368 -> $65,400,318,812.08
  Local search round 4: move trade 54 (1->0), IM -$451,087,453 -> $64,949,231,359.08
  Local search round 5: move trade 89 (0->1), IM -$1,557,451,376 -> $63,391,779,983.43
  Local search round 6: move trade 98 (0->1), IM -$1,223,078,128 -> $62,168,701,855.92
  Local search round 7: move trade 41 (2->1), IM -$502,404,683 -> $61,666,297,173.32
  Local search round 8: move trade 34 (2->0), IM -$557,766,532 -> $61,108,530,641.55
  Local search round 9: move trade 64 (1->2), IM -$216,671,887 -> $60,891,858,754.69
  Local search round 10: move trade 95 (0->1), IM -$126,121,069 -> $60,765,737,685.74
  Local search complete: 10 moves
  Local search saved: $109,668,508,345

Optimization Summary:
  Method:              gradient_descent
  Iterations:          20 (converged)
  Initial IM:          $170,434,246,031.14
  Optimized IM:        $ 60,765,737,685.74
  Reduction:           64.3%
  Trades moved:        10 of 100
  Optimization time:   13.548 s

Group   Trades           IM (USD)   CRIF (s)   SIMM (s)  # Sens dIM/ds (s)
--------------------------------------------------------------------------
  0         33  94,782,271,769.65      3.710   0.554105     185      2.021
  1         36  57,606,968,655.84      3.579   0.549417     191      2.198
  2         31  60,187,011,276.55      3.501   0.548682     175      1.609
--------------------------------------------------------------------------
  ALL      100 212,576,251,702.05     10.790   1.652204     551      5.828

Timing Summary (AADC):
  CRIF (AADC):       10.790 s (3 groups)
  SIMM aggregation:  1.652204 s (3 groups)
  IM gradient (AADC): 5.828 s (551 sensitivities, single adjoint)
  Optimization:      13.548 s (20 iterations, 10 trades moved)
  Total:             31.818 s

Execution logged to /home/natashamanito/ISDA-SIMM/data/execution_log_portfolio.csv
================================================================================
